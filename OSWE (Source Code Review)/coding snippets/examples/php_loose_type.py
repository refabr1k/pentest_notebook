import hashlib
import string
import itertools
import re


prefix_length = 8
pw_hash = "0e902564435691274142490923013038"
salt = "f789bbc328a3d1a3".encode('utf-8')

def gen_code():

    

    count = 0

    strings_array = string.ascii_lowercase + string.ascii_uppercase + string.digits

    # for word in map(''.join, itertools.product(string.printable, repeat=int(prefix_length))):
    for word in map(''.join, itertools.product(strings_array, repeat=int(prefix_length))):
        word = word.encode('utf-8')  # Encode the word before hashing
        hash_value = hashlib.md5((salt + word)).hexdigest()
        word_str = word.decode("utf-8")
        # print(f"comparing... hash {hash_value} == {pw_hash}")

        if re.match(r'0+[eE]\d+$', hash_value):
            # print('', flush=True)
            print(f'found password: {word.decode("utf-8")}')  # Decode the word for printing
            print(f'after {count} tries')
            break
            # print('')
        count += 1




def test():
    test_pw = "aaaaqcm2" #modify here
    word = test_pw.encode('utf-8')
    hash_value = hashlib.md5((salt + word)).hexdigest()
    print(f"comparing... hash {hash_value} == {pw_hash}")
    if re.match(r'0+[eE]\d+$', hash_value):
        # print('', flush=True)
        print(f'found password: {word.decode("utf-8")}')  # Decode the word for printing

def main():
    # gen_code()
    test()



if __name__ == "__main__":
    main()
