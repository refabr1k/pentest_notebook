
# Domain Enum Basic (PowerView, ADModule)
(1) PowerView syntax
(2) ADModule syntax

## Get current domain
```powershell
(1)
Get-NetDomain
(2)
Get-ADDomain
```

## Get object of another domain
```powershell
(1)
Get-NetDomain -Domain moneycorp.local

(2)
Get-ADDomain -Identity moneycorp.local
```

## Get current domain SID
```powershell
(1)
Get-DomainSID

(2)
(Get-ADDomain).DomainSID
```

## Get current domain policy
```powershell
(1)
Get-DomainPolicy

(2)
(Get-DomainPolicy)."system access"
```

## Get other domain policy
```powershell
(2)
(Get-DomainPolicy -domain moneycorp.local)."system access"
```

## Get current domain controllers
```powershell
(1)
Get-NetdomainController

(2)
Get-ADDomainController
```

## Get other domain controllers
```powershell
(1)
Get-NetDomainController -Domain moneycorp.local

(2)
Get-ADDomainController -DomainName moneycorp.local -Discover
```

## Get current domain users
```powershell
(1)
Get-NetUser
Get-NetUser -name student1

(2)
Get-ADUser -Filter * -Properties *
Get-ADUser -Identity student1 -Properties *
```

## Get current domain users properties
```powershell
(1)
# didnt work from course notes
Get-UserProperty
Get-UserProperty -Properties pwdlastset
# These work instead
Get-NetUser | select name,pwdlastset


(2)
Get-ADUser -Filter * -Properties * | select -First 1 | Get-Member -MemberType *Property | select Name
Get-ADUser -Filter * -Properties * | select name,@{expression={[datetime]::fromFileTime($_.pwdlastset)}}
```

## search string in user attributes
```powershell
(1)
Find-UserField -SearchField Description -SearchTerm "built"

(2)
Get-ADUser -Filter 'Description -like "*built*"' -Properties Description | select name,Description
```

## Get current domain list of computers
```powershell
(1)
Get-NetComputer
Get-NetComputer -OperatingSystem "*Server 2016*"
Get-NetComputer -Ping
Get-NetComputer -FullData

(2)
Get-ADComputer -Filter * | select Name
Get-ADComputer -Filter 'OperatingSystem -like "*Server 2016*"' -Properties OperatingSystem | select Name,OperatingSystem
Get-ADComputer -Filter * -Properties DNSHostName | %{Test-Connection -Count 1 -ComputerName $_.DNSHostName}
Get-ADComputer -Filter * -Properties *

```

## Get all groups in current domain
```powershell
(1)
Get-NetGroup
Get-NetGroup -Domain <targetdomain>
Get-NetGroup -FullData

(2)
Get-ADGroup -Filter * | select Name
Get-ADGroup -Filter * -Properties *
```

## Get all groups containing "admin"
```powershell
(1)
Get-Netgroup *admin*

(2)
Get-ADGroup -Filter 'Name -like "*admin*"' | select Name
```


## Get Domain admins group members
```powershell
(1)
Get-NetGroupMember -GroupName "Domain Admins" -Recurse

(2)
Get-ADGroupMember -Identity "Domain Admins" -Recursive
```

## Get user's Group
```powershell
(1)
Get-NetGroup -UserName "student1"

(2)
Get-ADPrincipalGroupMembership -Identity student1
```


## List all local groups on machine
Need administrator privs on non-dc machines
```powershell
(1)
Get-NetLocalGroup -ComputerName dcorp-dc.dollarcorp.moneycorp.local -ListGroups
```

## Get members of all local groups on a machine
Need administrator privs on non-dc machines
```powershell
(1)
Get-NetLocalGroup -ComputerName dcorp-dc.dollarcorp.moneycorp.local -Recurse
```


## Get actively logged users
Needs local admin rights
```powershell
(1)
Get-NetLoggedon -ComputerName <servername
```

## Get locally logged users
Needs remote registry on the target - started by-default on server OS
```powershell
(1)
Get-LoggedonLocal -ComputerName dcorp-dc.dollarcop.moneycorp.local
```

## Get last logged user
Needs administrative rights and remote registry on the target
```powershell
(1)
Get-LastLoggedOn -ComputerName <servername>
```

## Find shares on host in current domain
```powershell
(1)
Invoke-ShareFinder -Verbose
```

## Find sensitive files on computers in domain
```powershell
(1)
Invoke-FileFinder -Verbose
Invoke-FileFinder -ExcludeStandard -ExcludePrint -ExcludeIPC -Verbose

```


## Get all fileservers of domain
```powershell
(1)
Get-NetFileServer
```
