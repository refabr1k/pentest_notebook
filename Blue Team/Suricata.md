
# How to setup

https://suricata.readthedocs.io/en/suricata-6.0.0/quickstart.html

```bash
sudo apt update
sudo apt install suricata
sudo vim /etc/suricata/suricata.yaml

# remember to modify the interface which you are monitoring, eg. `interface: enp1s0` 

# update signatures/rules
sudo suricata-update

# starting service
sudo systemctl restart suricata

# check service startup logs
sudo tail /var/log/suricata/suricata.log

# If its working you should see that 'rules' are loaded successfully and that it should not be 0 rules. and the following last line or similar should be observed

	#<Notice> - all 4 packet processing threads, 4 management threads initialized, engine started.

#check statistics
sudo tail -f /var/log/suricata/stats.log


#start monitoring log - alerts should pop here whenever a network packet matches any rule
sudo tail -f /var/log/suricata/fast.log
```

## configuring rules


check service startup logs where the rules are loaded from, the rules may be located at the following locations
```
/var/lib/suricata/rules/suricata.rules
/etc/suricata/rules/suricata.rules
```
Remember to restart service after modifying the file for changes to take effect

To learn about rules see:
https://suricata.readthedocs.io/en/suricata-6.0.0/rules/intro.html



## testing rules
You can add rules by modifying your `suricata.rules` file

To test if setup works we can 
1. observe logs `sudo tail -f /var/log/suricata/fast.log`

2. make this request `curl http://testmynids.org/uid/index.html`

The folloing rule should pick up an alert
```
alert ip any any -> any any (msg:"GPL ATTACK_RESPONSE id check returned root"; content:"uid=0|28|root|29|"; classtype:bad-unknown; sid:2100498; rev:7; metadata:created_at 2010_09_23, updated_at 2010_09_23;)
```


## Example rules:
