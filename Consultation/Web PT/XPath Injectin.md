# Defense
The best way to protect against XPath injection is to filter all input data. 

For example, jumping back over to the XPath authentication query, there are two fields, username, and password. The XPath query are mapped as a string type thus the reason for needing a filtering mechanism.

A good practice would be to filter out any non- alphanumerical character.

Here is a very basic example:
```
$username=filterChars($_GET['username']);
$password=filterChars($_GET['password']);
$query="//user[username/text()='".$username."' and password/text()='".$password."']/username"; 
```