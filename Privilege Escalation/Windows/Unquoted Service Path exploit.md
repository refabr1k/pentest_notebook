## Unquoted Service Paths

Privesc by uploading binary payload in service path to be executed eg. By service start/stop or reboot.   

How? Suppose we found: 
`C:\Program Files (x86)\Program Folder\A Subfolder\Executable.exe`

If you look at the registry entry for this service with Regedit you can see the ImagePath value is: 
`C:\Program Files (x86)\Program Folder\A Subfolder\Executable.exe` 

To be prevent it being exploited, the path should have been: 
 `C:\Program Files (x86)\Program Folder\A Subfolder\Executable.exe` 
 
 When Windows attempts to run this service, it will look at the following paths in order and will run the first EXE that it will find in sequence, hitting our exploit payload.

```text
C:\Program.exe
C:\Program Files.exe
C:\Program Files(x86)\Program Folder\A.exe
```

### To discover unquoted service path

```c
# With WMIC
wmic service get name,displayname,pathname,startmode |findstr /i "Auto" |findstr /i /v "C:\Windows\\" |findstr /i /v """ 

# With powershell/PowerUp
Get-ServiceUnquoted  
```
