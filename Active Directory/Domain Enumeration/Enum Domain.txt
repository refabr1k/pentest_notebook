
# ============Native AD module===========

$ADClass = [System.DirectoryServices.ActiveDirectory.Domain]
$ADClass::GetCurrentDomain()

Import-Module .\Microsoft.ActiveDirectory.Management.dll
Import-Module .\ActiveDirectory\ActiveDirectory.psd1

Get-ADDomain
Get-ADDomain -Identity kingslanding.local

# Enum Domain Controller
Get-ADDomainController

# Enum user
Get-ADUser -Filter *
Get-ADUser -Filter * -Properties * | select Name
get-aduser -identity patsy.toni -Properties *
get-aduser -filter * -properties *| select -First 1 | Get-Member -MemberType *Property | select name
get-aduser -filter * -properties * | select name, @{expression={[datetime]::fromFileTime($_.pwdlastset)}}

get-aduser -filter 'description -like "*"' -Properties Description |select name,Description

# =============Powerview=============

# Domain info
Get-NetDomain
Get-NetDomain -Domain kingslanding.local

# Domain SID
Get-DomainSID


# Domain Policy
Get-DomainPolicy

# system access policy
(Get-DomainPolicy)."system access"

# kerberos policy
(Get-DomainPolicy)."kerberos policy"

# Enum domain controller
Get-NetDomainController
Get-NetDomainController -Domain kingslanding.local

# Enum users
Get-NetUser
Get-NetUser | select cn
Get-NetUser -Username patsy.toni

# Display user properties
Get-UserProperty
Get-UserProperty -Properties pwdlastset


# Search description for string
find-userfield -searchfield Description

	samaccountname description
	-------------- -----------
	candace.ted    User Password _;1fn2Y$T{rV
	connie.melody  User Password lvx+9BbH&4/M
	eddie.enid     User Password pCo{ffb8rh&f
	dee.ahmad      User Password y483g@YO%ljf


find-userfield -searchfield Description -SearchTerm "built"