
# Execute commands on single
```powershell
# Run a script on remote server
Invoke-Command -ComputerName <computername> -ScriptBlock{whoami;hostname}
```

## Function
```powershell
# create a script
hello.ps1
{
Write-Output "Hello from function"
}

# Run local function on remote machine
Invoke-Command -ComputerName <computername> -ScriptBlock ${function:hello}
```


## Load script to session
```powershell
Invoke-Command -FilePath C:\abc\def\hello.ps1 -Session $sess
Enter-PSSession -Session $sess
hello

```
---

NOTE: You may encounter an error when running scripts remotely eg. `"Method invocation is supported only on core types in this language mode."`

This is possibly because target is running in a `ConstraintedLanguage` mode. see [[Constrained Language Mode (CLM) How To overcome]]

This can be checked by running 
```powershell
Invoke-Command -ComputerName <computeName> -scriptBlock{$ExecutionContext.SessionState.LanguageMode}
```


## Running over list of servers
```powershell
# run script on a list of servers
Invoke-Command -ScriptBlock{Get-Process} -ComputerName (Get-Content <list_of_servers>)
```

## Run commands from file
```powershell
# run script on a list of servers
Invoke-Command -FilePath C:\scripts\Get-PassHashes.ps1 -ComputerName (Get-Content <list_of_servers>)
```
