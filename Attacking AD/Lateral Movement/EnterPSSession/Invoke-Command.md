# One-to-One
```powershell
# Admin Privs required, desktop windows machine
Enable-PSRemoting

# Creating a stateful session
$sess = New-PSSession -ComputerName <computername>

# prints session
$sess

# Enter session
Enter-PSSession -Session $sess

# having a Admin session in the computer
Enter-PSSession -ComputerName dcorp-adminsrv.moneycorp.local

```


# One-to-Many
## ScriptBlock - execute commands on single
```powershell
# Run a script on remote server
Invoke-Command -ComputerName <computername> -ScriptBlock{whoami;hostname}
```

## ScriptBlock - Function
```powershell
# create a script
hello.ps1
{
Write-Output "Hello from function"
}

# Run local function on remote machine
Invoke-Command -ComputerName <computername> -ScriptBlock ${function:hello}
```


## ScriptBlock - load script to session
```powershell
Invoke-Command -FilePath C:\abc\def\hello.ps1 -Session $sess
Enter-PSSession -Session $sess
hello

```
---

NOTE: You may encounter an error when running scripts remotely eg. `"Method invocation is supported only on core types in this language mode."`

This is possibly because target is running in a `ConstraintedLanguage` mode

This can be checked by running 
```powershell
Invoke-Command -ComputerName <computeName> -scriptBlock{$ExecutionContext.SessionState.LanguageMode}
```

---

## ScriptBlock - list of servers
```powershell
# run script on a list of servers
Invoke-Command -ScriptBlock{Get-Process} -ComputerName (Get-Content <list_of_servers>)
```

## FilePath - run commands from file
```powershell
# run script on a list of servers
Invoke-Command -FilePath C:\scripts\Get-PassHashes.ps1 -ComputerName (Get-Content <list_of_servers>)
```
