# Description
https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/17-Testing_for_Host_Header_Injection

https://portswigger.net/web-security/host-header

## What is host-header used for?
Host Header specifies which website should process the HTTP request. The web server uses the value of this header to dispatch the request to the specified website.

## Finding
An attacker can manipulate the Host header and cause the application to behave in unexpected ways. For an instance, modifying the Host header to an arbitrary host can allow a user to be redirected to a attacker controlled URL.

# Impact
- It can also lead to Phishing Attacks.
- Cross Site Scripting - XSS can be performed, if the value of Host header is used for writing links without HTML-encoding. For example Joomla used to write Host header to every page without HTML Encoding like this: `<link href=”http://_SERVER['HOST']”>`` which led to cross site scripting.
- Web Cache Poisoning-Manipulating caching systems into storing a page generated with a malicious Host and serving it to others.
- Password Reset Poisoning-Exploiting password reset emails and tricking them to deliver poisoned content directly to the target.

# Recommendation
- The simplest approach is to avoid using the Host header altogether in server-side code
- Validate the Host header
- If you must use the host header as a mechanism for identifying the location of the web server:
- Whitelisting permitted domains, To prevent routing-based attacks on internal infrastructure, you should configure your load balancer or any reverse proxies to forward requests only to a whitelist of permitted domains.
