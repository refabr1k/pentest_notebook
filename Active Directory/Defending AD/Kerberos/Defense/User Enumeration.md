https://docs.microsoft.com/en-us/defender-for-identity/reconnaissance-alerts

In account enumeration reconnaissance, an attacker uses a dictionary with thousands of user names, or tools such as KrbGuess in an attempt to guess user names in the domain.


# Understanding how User enumeration is possible

**Kerberos**: Attacker makes Kerberos requests using these names to try to find a valid username in the domain. When a guess successfully determines a username, the attacker gets the **Preauthentication required** instead of **Security principal unknown** Kerberos error.

**NTLM**: Attacker makes NTLM authentication requests using the dictionary of names to try to find a valid username in the domain. If a guess successfully determines a username, the attacker gets the **WrongPassword (0xc000006a)** instead of **NoSuchUser (0xc0000064)** NTLM error.

In this alert detection, Defender for Identity detects where the account enumeration attack came from, the total number of guess attempts, and how many attempts were matched. If there are too many unknown users, Defender for Identity detects it as a suspicious activity. The alert is based on authentication events from sensors running on domain controller and AD FS servers.

**MITRE**

TABLE 1

Primary MITRE tactic

[Discovery (TA0007)](https://attack.mitre.org/tactics/TA0007/)

MITRE attack technique

[Account Discovery (T1087)](https://attack.mitre.org/techniques/T1087/)

MITRE attack sub-technique

[Domain Account (T1087.002)](https://attack.mitre.org/techniques/T1087/002/)


**Suggested remediation and steps for prevention**

1.  Contain the source [computer](https://docs.microsoft.com/en-us/defender-for-identity/investigate-a-computer).
    1.  Find the tool that performed the attack and remove it.
    2.  Look for users who were logged on around the same time as the activity occurred, as these users may also be compromised.
    3.  Reset their passwords and enable MFA or, if you've configured the relevant high-risk user policies in Azure Active Directory Identity Protection, you can use the [**Confirm user compromised**](https://docs.microsoft.com/en-us/cloud-app-security/accounts#governance-actions) action in the Cloud App Security portal.
2.  Enforce [Complex and long passwords](https://docs.microsoft.com/en-us/windows/device-security/security-policy-settings/password-policy) in the organization. Complex and long passwords provide the necessary first level of security against brute-force attacks. Brute force attacks are typically the next step in the cyber-attack kill chain following enumeration.

