# Domain Enum - GPO

(1) PowerView
(2) GroupPolicy Module (that is found the Microsoft signed dll found in all ActiveDirectory installation)
## Get current domain GPO list
```powershell
(1)
Get-NetGPO
Get-NetGPO -ComputerName dcorp-student1.dollarcorp.moneycorp.local

(2)
Get-GPO -All
Get-GPResultantSetOfPolicy -ReportType Html -Path C:\Users\Administrator\report.html (Provides RSoP)
```

## Get GPO(s) which use Restricted Groups or groups.xml
```powershell
(1)
Get-NetGPOGroup
```

## Get users in local group of machine
```powershell
(1)
Find-GPOComputerAdmin -Computername dcorp-student1.dollarcorp.moneycorp.local
```

## Get machines where user is member of a group
```powershell
(1)
Find-GPOLocation -UserName student1 -Verbose
```

## Get OUs in a domain
```powershell
(1)
Get-NetOU
Get-NetOU -FullData

```

## Get All machines in a specified OU
```powershell
(1)
Get-NetOU -OUName StudentMachines | %{Get-NetComputer -ADSpath $_}

# % 	a for loop for each object 
# %{Get-NetComputer}	For each loop run Get-NetComputer individually
# -ADSpath $_	list all computer path that belong to StudentMachines OU

```


## Get which GPO applied on a OU
Read GPOname from gplink attribute from Get-NetOU
```powershell
(1)
Get-NetGPO -GPOname "{AB289123-A23F-484A-12FE-82E28439DE8}"

# Copy LDAP associated CN from output of command below eg. AB301321-212D-21FF-B0BA-20987981D798
(Get-NetOU StudentMachine -FullData).gplink

#
Get-NetGPO -ADSpath 'LDAP://cn={AB301321-212D-21FF-B0BA-20987981D798}, cn=policies,cn=system,DC=dollarcorp,DC=moneycorp,DC=local'


(2)
Get-GPO -Guid AB289123-A23F-484A-12FE-82E28439DE8

```
