# Basics of SSL

How does it work?

1. Client -> Requests secure pages (https) -> webserver
2. Client <- Gets Public key and Digital cert <- webserver
3. Client -> Checks with CA if the certificate is valid -> CA
4. Client <- Digital certificate is validated <- DA 

		At this point, you get the green HTTPS icon shown on your browser URL path 
5. Client creates `symmetry key` and encrypt with Webserver public key -> Send it -> webserver uses its own private key pair to decrypte and get the `symmetric key`

		At this point both client and server can start communicating normally.
		
		This is also where "Key exchange algorithm" and "bulk encryption algorithm" comes in play.
		
		"Key exchange algorithm" - How the "Symmetric keys" is being exchanged. Once exchanged, this key will be used to encrypt/decrypt messages between client and server.
		
		"bulk encryption algorithm" - Used to encrypt the Data being sent.
		

# Basic elements of SSL


| SSL Element | Description | 
| -- | -- |
| Protocol | eg. TLS 1.2, 1.1, 1.0 |
| Key exchange algorithm | How symmetric keys will be exchanged Eg. DH, RSA, ECDH, ECDHE. |
| Authentication Algorithm | How server authenticates (and if client authentication will be carried out) eg. RSA, DSA, ECDSA |
| Bulk encryption | Which symmetric key algo will be used to encryp the actual data. Eg. AES256, 3DES, RC4|
| Message Authentication Code (MAC) algorithm | The method with data integrity checks are done. Eg. SHA,MD5 |


## examples
Example of  Cipher Suite: TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384

---

# SSL Self signed cert

## Description
It was discovered that SSL Self-signed certificates were used. The legitemacy of SSL certificate owner during communications may not be established as the SSL certificates are self-signed.

## Impact
Using SSL certificates that cannot be verified by an authority exposes the risks of allowing an attacker in the network to establish a man-in-the-middle attack.

## Recommendation
It is recommended to utilise SSL certificates that are signed or generated by a recognised certificate authority.

--- 
# SSL RC4 Cipher Suites Supported (Bar Mitzvah)

## Description
RC4 is used for bulk encryption for data encryption between client and server transmission

## impact
- RC4 cipher is known to be flawed and it is possible to recover plaintext of repeatedly encrypted data
- How? If an attacker can obtain tens of millions of ciphertext, they could have means to derive the platintext of encrypted messages - as RC4 cipher has a flaw that decreases the randomness when  generation of random stream of bytes.

## recommendation
- Avoid the use of RC4 ciphers. 
- Consider using TLS 1.2 with AES-CGM suites subject to browser and web support


---
	
# TLS 1.0 Detected

## Description
TLS 1.0 are known to have cryptographic design flaws and should not be used whenver possible.

## Impact
Having the option of TLS 1.0 protocol may allow an attacker to force connections to downgrade to use the protcol for communicates. Also, TLS 1.0 is vulnerable to widely known SSL attacks such as BEAST which allows an attacker to tap into conversation through man-in-the-middle attacks.

## Recommendation
It is recommended to disable use of TLS 1.0, and only enable support for TLS 1.2 and 1.3.

---
	
# SSL Medium strength cipher SWEET 32

## Description 
It was discovered that affected hosts supports the use of SSL ciphers that offer medium strength encryption. The encryption key length of less than 64 bits and 3DES encryption in use are considered weaker than modern standards. 

## Impact
According to CVE-2016-2183, The 3DES ciphers in used are vulnerable to collision attacks (or birthday attacks) which when exploited, allows an attacker to recover plaintext from encrypted messages.

## Recommendation
It is recommended to configure the use of stronger ciphers used by services.

---

# SSL/TLS Diffie-Hellman Modulus <= 1024 Bits (Logjam)
[CVE-2015-4000](https://www.tenable.com/cve/CVE-2015-4000)

## Description
The Key exchange algorithm (diffie-hellman) was found to be using a lower than recommended key size. A higher key size, the better security it provides. 

## Impact
Attacker may be able to find the shared secret in a short amount of time (depending on modulus size and attacker resources). This may allow an attacker to recover the plaintext or potentially violate the integrity of connections.

## Recommendation
Reconfigure the service to use a unique Diffie-Hellman moduli of 2048 bits or greater.